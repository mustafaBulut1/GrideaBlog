<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GrideaForum</title>
    <link rel="stylesheet" href="homepage.css">
</head>
<body>
    <nav class="navbar"> 
        <div class="navbar-left">
            <a href="../homepage.html">Gridea Forum</a>
           
        </div>

        <div class="navbar-right">
            <div class="user-area">
                <a href="../login.html"  class="btn">GiriÅŸ Yap</a>
            </div>
            <div class="write-area">
                <a href="../addPost.html"  class="btn">Yaz</a>
            </div>
                
        </div>
    </nav>

    <div id="posts"></div>

    <script>

        fetch('/session-info').then(res=>res.json()).then(data=>{
            const userArea = document.querySelector('.user-area');
            
            if(data.loggedIn){
                userArea.innerHTML=`
                    <span style="margin-right: 10px;">ðŸ‘¤ ${data.user.username}</span>
                    <a href="/profile.html" class="btn">Profilim</a>
                    <a href="/logout" class="btn">Ã‡Ä±kÄ±ÅŸ Yap</a>
                `;
            }else{
                userArea.innerHTML=`
                    <a href="/login.html" class="btn">GiriÅŸ Yap</a>
                `;
            }
            
            /*
            const usernameSpan= document.createElement('span');
            usernameSpan.textContent= `ðŸ‘¤ ${data.username}`;
            
            const logoutLink = document.createElement('a');
            logoutLink.textContent='Ã‡Ä±kÄ±ÅŸ Yap';
            logoutLink.href= '/logout';
            logoutLink.className='btn';

            userArea.appendChild(usernameSpan);
            userArea.appendChild(logoutLink);
            */

        });

        async function fetchPosts() {
            try {
                const response = await fetch('/posts');  // Sunucudan veri Ã§ek
                const posts = await response.json();      // JSON'a Ã§evir
                console.log(posts);  // Kontrol iÃ§in verileri yaz
    
                const postsDiv = document.getElementById('posts');  // ID'si "posts" olan div
                postsDiv.innerHTML = '';  // Ã–ncekileri temizle
    
                posts.forEach(post => {
                    const blogCard = document.createElement('div');
                    blogCard.className = 'blog-card';
    
                    blogCard.innerHTML = `
                        <div class="blog-image">
                            <img src="/media/${post.category}.jpg" alt="${post.category}">
                        </div>
                        <div class="blog-content">
                            <h2>${post.title}</h2>
                            <p>${post.content.substring(0, 150).replace(/<[^>]+>/g, '')}...</p>
                            <a href="/post.html?id=${post.id}" class="read-more">DevamÄ±nÄ± Oku</a>
                        </div>
                        
                    `;

    
                    postsDiv.appendChild(blogCard);
                });
    
            } catch (error) {
                console.error('PostlarÄ± Ã§ekerken hata oluÅŸtu:', error);
            }
        }
    
        // Sayfa yÃ¼klenince fetchPosts Ã§alÄ±ÅŸsÄ±n
        window.addEventListener('DOMContentLoaded', fetchPosts);
    </script>
    



    <footer class="footer">
        <p>Â© 2025 Gridea Forum. TÃ¼m HaklarÄ± SaklÄ±dÄ±r.</p>
    </footer>
    
    
</body>
</html>